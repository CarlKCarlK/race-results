<!DOCTYPE html>
<html>

<head>
  <title>Race Results</title>
  <style>
    textarea {
      width: 100%;
      height: 200px;
    }

    button {
      margin-top: 10px;
    }
  </style>
</head>

<body data-server-no-reload>
  <h1>Race Results</h1>
  <label for="members">Members</label>
  <input type="file" id="members" accept=".txt">
  <p></p>
  <label for="results">Results</label>
  <textarea id="results"></textarea>
  <button onclick="callWasmFunction()">Match with City</button>
  <button onclick="callWasmFunction()">Match w/o City</button>
  <label for="matches">Matches</label>
  <textarea id="matches" readonly></textarea>
  <script type="module">
    import init, { member_match } from './pkg/web1.js';

    function callWasmFunction() {
      var fileInput = document.getElementById('members');
      var file = fileInput.files[0];
      alert(file.name);

      if (file) {
        alert("if file");
        var reader = new FileReader();

        reader.onload = function (e) {
          var members = e.target.result;
          var results = document.getElementById('results').value;
          alert("in onload");
          // cmk add logic for the two buttons
          var wasmOutput = member_match(members, results, false);
          document.getElementById('matches').value = wasmOutput;
        }
        reader.readAsText(file)
      }
      else
        alert("No Members file");
    };
    window.callWasmFunction = callWasmFunction;
    init();
  </script>
</body>

</html>